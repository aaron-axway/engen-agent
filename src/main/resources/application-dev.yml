spring:
  application:
    name: webhook-service
    
  datasource:
    url: ${DATABASE_URL:jdbc:h2:file:./data/webhook_db}
    username: ${DATABASE_USERNAME:sa}
    password: ${DATABASE_PASSWORD:}
    driver-class-name: ${DATABASE_DRIVER:org.h2.Driver}
  
  h2:
    console:
      enabled: true
      path: /h2-console
  
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        dialect: ${HIBERNATE_DIALECT:org.hibernate.dialect.H2Dialect}
        format_sql: true
    show-sql: false
  
  mail:
    host: ${EMAIL_SMTP_HOST:localhost}
    port: ${EMAIL_SMTP_PORT:1025}
    username: ${EMAIL_SMTP_USERNAME:}
    password: ${EMAIL_SMTP_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${EMAIL_SMTP_AUTH:false}
          starttls:
            enable: ${EMAIL_SMTP_STARTTLS:false}
          ssl:
            enable: false
            trust: "*"
            checkserveridentity: false
          connectiontimeout: ${EMAIL_CONNECTION_TIMEOUT:5000}
          timeout: ${EMAIL_TIMEOUT:5000}
          writetimeout: ${EMAIL_WRITE_TIMEOUT:5000}

server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /

logging:
  level:
    root: INFO
    com.engen.webhookservice: INFO
    org.springframework.security: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"

webhook:
  axway:
    secret: ${AXWAY_WEBHOOK_SECRET:}
    token: ${AXWAY_WEBHOOK_TOKEN:}
    ignored-event-types: ${AXWAY_IGNORED_EVENT_TYPES:SubResourceUpdated}
    api:
      base-url: ${AXWAY_API_BASE_URL:https://api-env.demo.axway.com}
      token: ${AXWAY_API_TOKEN:}
    platform:
      base-url: ${AXWAY_PLATFORM_BASE_URL:https://platform.axway.com/api/v1}
  
  servicenow:
    secret: ${SERVICENOW_WEBHOOK_SECRET:}
    username: ${SERVICENOW_WEBHOOK_USERNAME:}
    password: ${SERVICENOW_WEBHOOK_PASSWORD:}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

email:
  enabled: ${EMAIL_ENABLED:false}
  from: ${EMAIL_FROM:noreply@engen-webhook.com}
  to: ${EMAIL_TO:}
  cc: ${EMAIL_CC:}
  subject:
    prefix: ${EMAIL_SUBJECT_PREFIX:[Webhook Service]}

servicenow:
  api:
    table-name: ${SERVICENOW_TABLE_NAME:amplify_access_request}

event:
  cleanup:
    enabled: ${EVENT_CLEANUP_ENABLED:false}  # Disabled in dev by default
    retention-days: ${EVENT_RETENTION_DAYS:7}  # Shorter retention in dev
    batch-size: ${EVENT_CLEANUP_BATCH_SIZE:100}
    cron: ${EVENT_CLEANUP_CRON:0 0 2 * * ?}
    ignored-cron: ${EVENT_CLEANUP_IGNORED_CRON:0 30 1 * * ?}