# Webhook Service Environment Configuration Example
# Copy this file to .env and update with your actual values

# ===========================
# Server Configuration
# ===========================
SERVER_PORT=8080
SPRING_PROFILES_ACTIVE=dev

# ===========================
# Database Configuration
# ===========================
DATABASE_URL=jdbc:h2:file:./data/webhook_db;DB_CLOSE_ON_EXIT=FALSE
DATABASE_USERNAME=sa
DATABASE_PASSWORD=
H2_CONSOLE_ENABLED=true

# ===========================
# Axway Amplify Configuration
# ===========================
# Webhook authentication
AXWAY_WEBHOOK_SECRET=your-hmac-secret-key-here
AXWAY_WEBHOOK_TOKEN=your-bearer-token-here

# API callback configuration
AXWAY_API_BASE_URL=https://apicentral.axway.com
AXWAY_API_TOKEN=your-api-token-for-callbacks

# ===========================
# Axway Amplify OAuth Configuration
# ===========================
# JWT-based OAuth for Axway/Amplify API access
AXWAY_OAUTH_ENABLED=false
AXWAY_OAUTH_CLIENT_ID=your-axway-client-id
AXWAY_OAUTH_TOKEN_ENDPOINT=https://login.axway.com/auth/realms/Broker/protocol/openid-connect/token

# Keys can be provided as file paths OR base64-encoded env vars
# Base64 env vars take precedence if both are provided
# Option 1: File paths (legacy)
AXWAY_OAUTH_PRIVATE_KEY_PATH=private_key.pem
AXWAY_OAUTH_PUBLIC_KEY_PATH=public_key.pem

# Option 2: Base64-encoded keys (recommended for containerized environments)
# To convert PEM to base64: cat private_key.pem | base64 -w0
AXWAY_OAUTH_PRIVATE_KEY_BASE64=
AXWAY_OAUTH_PUBLIC_KEY_BASE64=

AXWAY_OAUTH_TOKEN_CACHE_MINUTES=55

# ===========================
# ServiceNow Configuration
# ===========================
# Webhook authentication (for incoming webhooks)
SERVICENOW_WEBHOOK_USERNAME=webhook-integration-user
SERVICENOW_WEBHOOK_PASSWORD=secure-password-here
SERVICENOW_WEBHOOK_SECRET=your-servicenow-hmac-secret

# ===========================
# Highmark OAuth & Catalog API Configuration
# ===========================
# Highmark OAuth for ServiceNow Catalog API Access
# Note: Identity domain is passed as query parameter (e.g., ?identityDomain=AmplifyMarketPlacev3)
HIGHMARK_OAUTH_ENABLED=true
HIGHMARK_OAUTH_AUTH_METHOD=basic
HIGHMARK_OAUTH_TOKEN_URL=https://logintest.highmark.com/oauth2/rest/token
HIGHMARK_OAUTH_CLIENT_ID=your-highmark-client-id
HIGHMARK_OAUTH_CLIENT_SECRET=your-highmark-client-secret
HIGHMARK_OAUTH_IDENTITY_DOMAIN=AmplifyMarketPlacev3
HIGHMARK_OAUTH_SCOPE=resource.READ
HIGHMARK_OAUTH_TOKEN_CACHE_MINUTES=55

# JWT-specific configuration (only needed if HIGHMARK_OAUTH_AUTH_METHOD=jwt)
# HIGHMARK_OAUTH_USERNAME=jwt.integration.user
# HIGHMARK_OAUTH_KEY_ID=highmark-key-001
# HIGHMARK_OAUTH_PRIVATE_KEY_PATH=certs/highmark_private_key.pem

# Highmark Catalog API Configuration
HIGHMARK_CATALOG_API_ENABLED=true
HIGHMARK_CATALOG_BASE_URL=https://apiintdev.hmhs.com/snow/v1
HIGHMARK_CATALOG_ITEM_SYS_ID=2a10c025eb587a1ce2b7f1fbcad0cdda

# Default values for catalog variables
HIGHMARK_DEFAULT_DATA_GOVERNANCE=Internal
HIGHMARK_DEFAULT_DG_CLASS_TAGS=Standard
HIGHMARK_DEFAULT_APPROVAL_STATE=pending
HIGHMARK_DEFAULT_NEED_BY_DAYS=30

# ===========================
# Email Notification Configuration
# ===========================
# Enable/disable email notifications
EMAIL_ENABLED=false

# SMTP Server Configuration
EMAIL_SMTP_HOST=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USERNAME=your-email@domain.com
EMAIL_SMTP_PASSWORD=your-app-specific-password
EMAIL_SMTP_AUTH=true
EMAIL_SMTP_STARTTLS=true

# Email Recipients and Settings
EMAIL_FROM=noreply@webhook-service.com
EMAIL_TO=admin@company.com,team@company.com
EMAIL_CC=manager@company.com
EMAIL_SUBJECT_PREFIX=[Webhook Service]

# Email Connection Timeouts (milliseconds)
EMAIL_CONNECTION_TIMEOUT=5000
EMAIL_TIMEOUT=5000
EMAIL_WRITE_TIMEOUT=5000

# ===========================
# Email Template Customization
# ===========================
# Email templates are defined in src/main/resources/email-templates.yml
# Templates use simple {placeholder} syntax for variable substitution
#
# Available Templates:
# - servicenowTicket: Notification when ServiceNow ticket is created
# - approval: Notification for approval workflow events
# - error: Notification when event processing fails
#
# Template Placeholders:
# servicenowTicket: {ticketId}, {eventId}, {eventType}, {source}, {correlationId}, {timestamp}, {payloadSection}
# approval: {approvalStatus}, {approvalStatusColor}, {eventId}, {eventType}, {correlationId}, {commentsRow}, {timestamp}
# error: {eventId}, {eventType}, {source}, {errorMessage}, {exceptionSection}, {timestamp}
#
# To customize email templates:
# 1. Edit src/main/resources/email-templates.yml
# 2. Modify subject lines and HTML body content as needed
# 3. Restart the application to load changes
# 4. No code changes required!

# ===========================
# OAuth Startup Health Check
# ===========================
# Controls behavior when OAuth services fail at startup
OAUTH_STARTUP_HEALTH_CHECK_ENABLED=true
OAUTH_STARTUP_SHUTDOWN_ON_FAILURE=false  # Set to false for Kubernetes (let readiness probe handle it)
OAUTH_STARTUP_REQUIRED_SERVICES=axway,highmark

# ===========================
# Event Cleanup Configuration
# ===========================
EVENT_CLEANUP_ENABLED=false
EVENT_RETENTION_DAYS=30
# EVENT_RETENTION_MINUTES=0  # If > 0, overrides retention-days
EVENT_CLEANUP_BATCH_SIZE=1000
EVENT_CLEANUP_CRON=0 0 2 * * ?
EVENT_CLEANUP_IGNORED_CRON=0 30 1 * * ?

# ===========================
# JVM Configuration (for startup script)
# ===========================
WEBHOOK_SERVICE_MEMORY=1g
WEBHOOK_DEBUG=false
WEBHOOK_MONITORING=false

# ===========================
# Common Email Provider Examples
# ===========================

# Gmail Configuration Example:
# EMAIL_SMTP_HOST=smtp.gmail.com
# EMAIL_SMTP_PORT=587
# EMAIL_SMTP_AUTH=true
# EMAIL_SMTP_STARTTLS=true
# Note: Use App Password, not regular password

# Office 365 Configuration Example:
# EMAIL_SMTP_HOST=smtp.office365.com
# EMAIL_SMTP_PORT=587
# EMAIL_SMTP_AUTH=true
# EMAIL_SMTP_STARTTLS=true

# SendGrid Configuration Example:
# EMAIL_SMTP_HOST=smtp.sendgrid.net
# EMAIL_SMTP_PORT=587
# EMAIL_SMTP_USERNAME=apikey
# EMAIL_SMTP_PASSWORD=your-sendgrid-api-key
# EMAIL_SMTP_AUTH=true
# EMAIL_SMTP_STARTTLS=true

# Amazon SES Configuration Example:
# EMAIL_SMTP_HOST=email-smtp.us-east-1.amazonaws.com
# EMAIL_SMTP_PORT=587
# EMAIL_SMTP_USERNAME=your-ses-smtp-username
# EMAIL_SMTP_PASSWORD=your-ses-smtp-password
# EMAIL_SMTP_AUTH=true
# EMAIL_SMTP_STARTTLS=true

# Internal SMTP Server Example (No Auth):
# EMAIL_SMTP_HOST=mail.internal.company.com
# EMAIL_SMTP_PORT=25
# EMAIL_SMTP_AUTH=false
# EMAIL_SMTP_STARTTLS=false